function doGet() {
  return HtmlService.createHtmlOutputFromFile('index')
      .setTitle('AI 生活小秘書 | 全方位數位輔助')
      .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL)
      .addMetaTag('viewport', 'width=device-width, initial-scale=1');
}

function doPostDirect(data) {
  try {
    var ss = SpreadsheetApp.getActiveSpreadsheet();
    var sheet = ss.getSheetByName("Account_Pool");
    if (!sheet) return "找不到 Account_Pool 分頁！";

    sheet.appendRow([
      "ID-" + new Date().getTime(),
      data.bankName,
      "'" + data.bankAccount,
      data.bankUser,
      0, 0, "啟用", 50, 150000
    ]);

    return "資料已成功入庫！"; 
  } catch (e) {
    return "後端報錯：" + e.toString();
  }
}
